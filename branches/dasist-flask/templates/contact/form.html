{% extends "contact/base.html" %}
{% from "__formhelper.html" import render_field %}
{% block head_js %}
<script type="text/javascript">
        function delContactAddress() {
		// del parent row; update ids below (?)
		console.log("del:");
		//target = $(this).parent().parent();
		//console.log(target);
		$(this).parent().parent().remove();
        };
        function addContactAddress() {
		// add row to end of children of table (id="contactaddresses")

		parent = $('#contactaddresses');
		i = parent.children().length;
		console.log('add: '+i);
		a = $('<tr> <td> <input id="addresses-'+i+'-value" name="addresses-'+i+'-value" type="text"> </td> <td> <button type="button" onClick="delContactAddress();"> x </button> </td> </tr>');
		a.appendTo(parent);
        };
</script>
{% endblock %}
{% if formerrors %} {{ form.errors }} {% endif %}
{% block content %}
<form method=post action=".">
{{ form.hidden_tag() }}
  <table>
    {{ render_field(form.lastname) }}
    {{ render_field(form.firstname) }}
    {{ render_field(form.midname) }}
    {{ render_field(form.birthdate) }}
    <tr>
      <th> Адреса: </th>
      <td>
        <table border="1">
	  <thead>
            <tr> <th> Адрес </th> <th/> </tr>
	  </thead>
	  <tbody id="contactaddresses">
          {% for address in form.addresses %}
            <tr>
	      <td> {{ address.value }}
                {% if address.value.errors %}
                  <ul class=errors> {% for error in address.value.errors %} <li>{{ error }}</li> {% endfor %} </ul>
                {% endif %}
	      </td>
	      <td/>
	    </tr>
          {% endfor %}
	  </tbody>
        <table>
	<button type="button" onClick='addContactAddress();'> + </button>
      </td>
    </tr>
    {# render_field(form.newaddress) #}
  </table>
  <p>
	<button type="submit"> Save </button>
	{% if id %}
	  <a href="{{ url_for('contact.view', id=id) }}">
	{% else %}
	  <a href="{{ url_for('contact.index') }}">
	{% endif %}
	<button type="button"> Cancel </button> </a>
  </p>
</form>
{% endblock %}
